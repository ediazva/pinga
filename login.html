<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="styles/default.css">
    <link rel="stylesheet" href="styles/icons.css">
    <style>
        #left {
            position: fixed;
            top: 0;
            background-color: green;
            width: 30vw;
        }

        #right {
            margin-left: 30vw;
            padding: 0 1rem;
        }

        .timer {
            position: fixed;
            right: 0;
            text-align: right;
            margin-top: 1.3rem;
        }

        .volver {
            display: inline-flex;
            align-items: center;
            color: var(--gray);
            font-family: Flexo-Demi;
            font-size: 0.9rem;
            padding-top: 4rem;
            text-decoration: none;
        }

        h2 {
            margin: auto;
            padding: 20px;
            color: #25499C;
        }

        .bcp-form {
            display: flex;
            flex-direction: column;
            row-gap: 1.7rem;
            margin: auto;
            margin-top: 1rem;
            width: 35%;
        }

        #tipo-cuenta {
            display: flex;
            column-gap: 2rem;
        }

        #tipo-cuenta div {
            display: flex;
            column-gap: 1rem;
        }

        input[type=radio] {
            margin: 0;
            padding: 0;
            appearance: none;
            width: 1rem;
            height: 1rem;
            border-radius: 50%;
            border: 2px solid var(--light-gray);
            transition: border 300ms ease;
        }
        
        input[type=radio]:hover {
            border: 2px solid var(--orange);
        }
        
        input[type=radio]:checked {
            border: 2px solid var(--orange);
            box-shadow: inset 0 0 0 .2rem white;
            background-color: var(--orange);
        }

        div:has(> input[type=checkbox]) {
            display: flex;
            align-items: center;
            column-gap: 0.5rem;
        }

        input[type=checkbox] {
            appearance: none;
            width: 1rem;
            height: 1rem;
            border: 2px solid var(--light-gray);
            border-radius: 10%;
            transition: border 300ms ease;
        }

        input[type=checkbox]:hover {
            border-color: var(--orange);
        }
        
        input[type=checkbox]:checked {
            background: url(/img/check-r-white-md.svg), var(--orange);
            background-position: 50% 50%;
            border-color: var(--orange);
        }
        
        .form-table {
            width: 100%;
            height: 50px;
            border-collapse: separate;
            border: 1px solid lightgray;
            border-radius: 6px;
            margin-top: 20px;
        }

        .down-arrow {
            margin-left: 5px;
            margin-right: 10px;
            filter: opacity(50%);
        }

        .bcp-number {
            font-size: larger;
            border: none;
            width: 90%;
            height: 100%;
            line-height: 100%;
        }

        #captcha {
            display: flex;
            height: 3rem;
            border-radius: 0.5rem 0 0 0.5rem;
        }

        #continuar-button {
            background-color: rgb(255, 150, 31);
            border-radius: 20px;
            line-height: 24px;
            margin: 0px;
            padding-left: 16px;
            padding-right: 16px;
            text-decoration: none;
            width: 300px;
            height: 40px;
            color: white;
            font-size: medium;
            border: none;
            margin-top: 20px;
        }
        
        #clave-menu {
            position: absolute;
            top: 100%;
            width: 100%;
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 0 0.7rem -0.5rem var(--black);
            border-spacing: 0.5rem;
        }

        .clave-button {
            font-family: Flexo-Bold;
            color: var(--gray);
            text-align: center;
            border: 1px solid var(--light-gray);
            padding: 0.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background 300ms ease-out;
        }

        .clave-button:hover {
            background: #eff0f2;
        }

        .clave-button-icon {
            color: var(--gray);
            cursor: pointer;
            text-align: center;
            padding: 0.5rem;
            font-size: 1.2rem;
        }
    </style>
</head>
<body class="default-theme">
    <img id="left" src="img/imagen-bcp.png">
    <div id="right">
        <div class="timer">Esta ventana se <b>cerrará</b> en <b id="timer">300</b> segundos<i style="font-size: x-large; padding-left: 1rem;" class="icon icon-chronometer-r"></i></div>
        <a class="volver" href="../principal/index.html">
            <i style="font-size: x-large; padding-bottom: 0.2rem;" class="icon icon-angle-left-r"></i>
             Volver
        </a>
        <h2 class="fw-bold text-center">Banca por Internet</h2>
        <form class="bcp-form">
            <div id="tipo-cuenta">
                <div>
                    <input type="radio" id="tipo-cuenta-persona" data-predicate="" name="tipo-cuenta" value="persona" checked/>
                    <label for="tipo-cuenta-persona">Persona</label>
                </div>
                
                <div>
                    <input type="radio" id="tipo-cuenta-empresa" name="tipo-cuenta" value="empresa" />
                    <label for="tipo-cuenta-empresa">Empresa</label>
                </div>
            </div>

            <div>
                <div class="input-group">
                    <select class="input-select">
                        <option>DNI</option>
                        <option>CE</option>
                        <option>PAS</option>
                    </select>
                    <input id="number" type="tel" maxlength="8" autocomplete="off" class="throwable" data-predicate="dni" placeholder="Nro de documento">
                </div>
                <label class="input-label" hidden>El número de documento está incompleto</label>
            </div>

            <div>
                <div class="input-floating-group">
                    <input id="tarjeta" type="tel" maxlength="19" autocomplete="off" class="throwable" data-predicate="tarjeta">
                    <label class="input-floating-text-static">Número de tarjeta</label>
                </div>
                <label class="input-label" hidden>El número de tarjeta está incompleto</label>
            </div>
            <div>
                <input type="checkbox" id="recordar" onchange="show_recordar_menu(this)">
                <label class="text-gray" for="recordar">Recordar datos</label>
            </div>
            <div id="recordar-menu" hidden>
                <label class="input-floating-text">Nombre de tarjeta</label>
                <div>
                    <div class="input-floating-group">
                        <input placeholder="" data-predicate="notempty" class="throwable">
                    </div>
                </div>
                <div style="font-size: small; color: var(--black); padding: 0.6rem 0 0 0.6rem;">
                    <b>Crea un nombre que tenga</b> <br>
                    - Al menos tres caracteres <br>
                    - Mínimo una letra y un número <br>
                    - Sin caracteres especiales ni espacios en blanco <br>
                    - Sin número al inicio
                </div>
            </div>
            
            <div>
                <div class="input-floating-group">
                    <input id="clave" type="password" maxlength="6" class="throwable" data-predicate="clave" readonly>
                    <label class="input-floating-text-static">Clave de internet de 6 dígitos</label>
                    <table id="clave-menu" hidden>
                        <tbody>
                            <tr>
                                <td class="clave-button"></td>
                                <td class="clave-button"></td>
                                <td class="clave-button"></td>
                                <td class="clave-button"></td>
                            </tr>
                            <tr>
                                <td class="clave-button"></td>
                                <td class="clave-button"></td>
                                <td class="clave-button"></td>
                                <td class="clave-button"></td>
                            </tr>
                            <tr>
                                <td class="clave-button-icon" onclick="clear_all_clave()"><i class="icon icon-trash-r"></i></td>
                                <td class="clave-button"></td>
                                <td class="clave-button"></td>
                                <td class="clave-button-icon" onclick="clear_one_clave()"><i class="icon icon-backspace-r"></i></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="display: flex; justify-content: space-between">
                    <a class="link link-orange" href="#">Crear clave</a>
                    <a class="link link-orange" href="#">Olvidé mi clave</a>
                </div>
            </div>
            
            <div>
                <div class="input-group">
                    <img id="captcha" src="img/captcha.jpeg">
                    <input placeholder="Código" maxlength="6" class="throwable" data-predicate="notempty">
                </div>
                <a class="link link-orange" href="#">Cambiar código</a>
            </div>
            <button type="button" id="continuar-button">Continuar</button>
        </form>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <script src="scripts/items.js"></script>

    <script>
        const timer = document.getElementById("timer");
        setInterval(() => {
            const num  = parseInt(timer.textContent);
            timer.textContent = num-1;
        }, 1000);
        
        function show_recordar_menu(self) {
            document.getElementById("recordar-menu").hidden = !self.checked;
        }

        $(".throwable").on("focusout", ev => default_input_behavior(ev.currentTarget));
        
        function dni(val) {
            return val.length == 8;
        }

        function tarjeta(val) {
            val = val.replace(/ /g, "");
            return val.length == 16;
        }

        function notempty(val) {
            return val.length != 0;
        }

        function clave(val) {
            return val.length == 6;
        }

        function show_clave_menu() {
            $("#clave-menu").show();
        }

        $("#tarjeta").on("input", (ev) => {
            let val = ev.currentTarget.value;
            if((val.length+1) % 5 == 0) {
                ev.currentTarget.value += " ";
            }
        });

        $("#clave").on("click", ev => {$("#clave-menu").show();})
        $(document).on("mouseup", ev => {
            const menu = $("#clave-menu");
            if(!menu.is(ev.target) && menu.has(ev.target).length == 0) {
                menu.hide();
                $("#clave").focusout();
            }
        });
        $("#clave-menu td").on("click", ev => {
            $("#clave").val(function() {
                return this.value.length < 6 ? this.value + ev.target.textContent : this.value;
            });
        });

        function clear_all_clave() {
            $("#clave").val("");
        }

        function clear_one_clave() {
            $("#clave").val(function () {
                return this.value.slice(0, this.value.length-1);
            });
        }

        /**
          * @param {HTMLElement} self  
          */
        function default_input_behavior(self) {
            const div = self.parentElement.parentElement;
            const label = div.querySelector(".input-label");
            if(window[self.dataset.predicate](self.value)) {
                div.removeAttribute("data-status");
                label.hidden = true;
            } else {
                div.setAttribute("data-status", "error");
                label.hidden = false;
            }
        }

        function load_button_content() {
            const text = Array.from("0123456789").map(x => ({x, sort: Math.random()})).sort((a,b) => a.sort - b.sort).map(({x}) => x);
            const td = document.querySelectorAll(".clave-button");
            for(let i = 0; i < td.length; ++i)
                td[i].textContent = text[i];
        }
        load_button_content();
    </script>
</body>